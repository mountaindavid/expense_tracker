# Ð”ÐµÑ‚Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ€Ð°Ð·Ð±Ð¾Ñ€ CI/CD Ñ„Ð°Ð¹Ð»Ð°

## ðŸ“‹ Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° GitHub Actions Workflow

### 1. Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº Ð¸ Ñ‚Ñ€Ð¸Ð³Ð³ÐµÑ€Ñ‹ (ÑÑ‚Ñ€Ð¾ÐºÐ¸ 1-7)

```yaml
name: CI

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main, develop ]
```

**Ð§Ñ‚Ð¾ ÑÑ‚Ð¾:**
- `name: CI` - Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ workflow (Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶Ð°ÐµÑ‚ÑÑ Ð² GitHub UI)
- `on:` - Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÑ‚, ÐºÐ¾Ð³Ð´Ð° Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ workflow

**ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚:**
```yaml
on: [push, pull_request]  # Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ Ð½Ð° Ð»ÑŽÐ±Ð¾Ð¹ push/PR
```

**Ð§Ñ‚Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾:**
- Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð¿Ð¾ Ð²ÐµÑ‚ÐºÐ°Ð¼ - Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð»Ñ `main` Ð¸ `develop`
- Ð­Ñ‚Ð¾ ÑÐºÐ¾Ð½Ð¾Ð¼Ð¸Ñ‚ Ñ€ÐµÑÑƒÑ€ÑÑ‹ Ð¸ Ð¿Ñ€ÐµÐ´Ð¾Ñ‚Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ Ð·Ð°Ð¿ÑƒÑÐº Ð½Ð° ÑÐ»ÑƒÑ‡Ð°Ð¹Ð½Ñ‹Ñ… Ð²ÐµÑ‚ÐºÐ°Ñ…

**Ð¡Ð¸Ð½Ñ‚Ð°ÐºÑÐ¸Ñ:**
- `push:` - ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ðµ push Ð² Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¹
- `branches:` - ÑÐ¿Ð¸ÑÐ¾Ðº Ð²ÐµÑ‚Ð¾Ðº, Ð´Ð»Ñ ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ñ… ÑÑ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ Ñ‚Ñ€Ð¸Ð³Ð³ÐµÑ€
- `pull_request:` - ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ðµ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ/Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ PR

---

## 2. Job: `test` (ÑÑ‚Ñ€Ð¾ÐºÐ¸ 10-62)

### 2.1 Ð‘Ð°Ð·Ð¾Ð²Ñ‹Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ job

```yaml
test:
  runs-on: ubuntu-latest
  
  env:
    DATABASE_URL: postgresql://postgres:postgres@localhost:5432/expensetracker_test
```

**Ð§Ñ‚Ð¾ ÑÑ‚Ð¾:**
- `runs-on:` - ÐžÐ¡ Ð´Ð»Ñ Ð·Ð°Ð¿ÑƒÑÐºÐ° (ubuntu-latest = Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÑÑ Ubuntu)
- `env:` - Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ, Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ðµ Ð²Ð¾ Ð²ÑÐµÑ… steps ÑÑ‚Ð¾Ð³Ð¾ job

**ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚:**
```yaml
test:
  runs-on: ubuntu-latest
  steps:
    - run: echo "Hello"
```

**Ð§Ñ‚Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾:**
- `env:` - Ð³Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ð°Ñ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð°Ñ Ð´Ð»Ñ Ð²ÑÐµÑ… ÑˆÐ°Ð³Ð¾Ð²
- Ð­Ñ‚Ð¾ Ð½ÑƒÐ¶Ð½Ð¾, Ñ‡Ñ‚Ð¾Ð±Ñ‹ `Settings()` Ð² `app/config.py` Ð¼Ð¾Ð³ Ð½Ð°Ð¹Ñ‚Ð¸ `DATABASE_URL`

---

### 2.2 Services (ÑÑ‚Ñ€Ð¾ÐºÐ¸ 16-29)

```yaml
services:
  postgres:
    image: postgres:15
    env:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: postgres
      POSTGRES_DB: expensetracker_test
    options: >-
      --health-cmd pg_isready
      --health-interval 10s
      --health-timeout 5s
      --health-retries 5
    ports:
      - 5432:5432
```

**Ð§Ñ‚Ð¾ ÑÑ‚Ð¾:**
- `services:` - ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ñ‹, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ°ÑŽÑ‚ÑÑ Ð”Ðž steps Ð¸ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹ Ð²Ð¾ Ð²Ñ€ÐµÐ¼Ñ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ
- Ð­Ñ‚Ð¾ Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Docker ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¶Ð¸Ð²ÐµÑ‚ Ð¿Ð°Ñ€Ð°Ð»Ð»ÐµÐ»ÑŒÐ½Ð¾ Ñ job

**ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚:**
```yaml
services:
  postgres:
    image: postgres:15
    env:
      POSTGRES_PASSWORD: postgres
    ports:
      - 5432:5432
```

**Ð§Ñ‚Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾:**
- `env:` Ð²Ð½ÑƒÑ‚Ñ€Ð¸ service - Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð´Ð»Ñ PostgreSQL ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð°
- `options:` - health check Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ (Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚, Ñ‡Ñ‚Ð¾ Ð‘Ð” Ð³Ð¾Ñ‚Ð¾Ð²Ð°)
- `--health-cmd pg_isready` - ÐºÐ¾Ð¼Ð°Ð½Ð´Ð° Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ð³Ð¾Ñ‚Ð¾Ð²Ð½Ð¾ÑÑ‚Ð¸
- `--health-interval 10s` - Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° ÐºÐ°Ð¶Ð´Ñ‹Ðµ 10 ÑÐµÐºÑƒÐ½Ð´
- `--health-timeout 5s` - Ñ‚Ð°Ð¹Ð¼Ð°ÑƒÑ‚ Ð½Ð° Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÑƒ
- `--health-retries 5` - Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº Ð¿ÐµÑ€ÐµÐ´ Ð¿Ñ€Ð¾Ð²Ð°Ð»Ð¾Ð¼

**Ð—Ð°Ñ‡ÐµÐ¼ health check:**
- GitHub Actions Ð¶Ð´ÐµÑ‚, Ð¿Ð¾ÐºÐ° ÑÐµÑ€Ð²Ð¸Ñ ÑÑ‚Ð°Ð½ÐµÑ‚ "healthy" Ð¿ÐµÑ€ÐµÐ´ Ð·Ð°Ð¿ÑƒÑÐºÐ¾Ð¼ steps
- Ð“Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ñ€ÑƒÐµÑ‚, Ñ‡Ñ‚Ð¾ Ð‘Ð” Ð³Ð¾Ñ‚Ð¾Ð²Ð° Ðº Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸ÑŽ

---

### 2.3 Steps - Ð±Ð°Ð·Ð¾Ð²Ñ‹Ðµ (ÑÑ‚Ñ€Ð¾ÐºÐ¸ 31-42)

```yaml
steps:
  - uses: actions/checkout@v3
  
  - name: Set up Python
    uses: actions/setup-python@v4
    with:
      python-version: '3.11'
  
  - name: Install dependencies
    run: |
      pip install --upgrade pip
      pip install -r requirements.txt
```

**Ð¡Ð¸Ð½Ñ‚Ð°ÐºÑÐ¸Ñ step:**
- `-` - ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚ ÑÐ¿Ð¸ÑÐºÐ° (ÐºÐ°Ð¶Ð´Ñ‹Ð¹ step - ÑÑ‚Ð¾ Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ð°Ñ Ð·Ð°Ð´Ð°Ñ‡Ð°)
- `name:` - Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ ÑˆÐ°Ð³Ð° (Ð²Ð¸Ð´Ð½Ð¾ Ð² Ð»Ð¾Ð³Ð°Ñ…)
- `uses:` - Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ Ð³Ð¾Ñ‚Ð¾Ð²Ñ‹Ð¹ action (Ð¿ÐµÑ€ÐµÐ¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼Ñ‹Ð¹ ÐºÐ¾Ð´)
- `run:` - Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ shell ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ
- `with:` - Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ Ð´Ð»Ñ action

**ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚:**
```yaml
steps:
  - uses: actions/checkout@v3
  - run: echo "test"
```

**Ð§Ñ‚Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾:**
- `actions/checkout@v3` - ÐºÐ»Ð¾Ð½Ð¸Ñ€ÑƒÐµÑ‚ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¹ (Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð´Ð»Ñ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº ÐºÐ¾Ð´Ñƒ)
- `actions/setup-python@v4` - ÑƒÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÑ‚ Python Ð½ÑƒÐ¶Ð½Ð¾Ð¹ Ð²ÐµÑ€ÑÐ¸Ð¸
- `with: python-version` - ÑƒÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ Ð²ÐµÑ€ÑÐ¸ÑŽ Python

**Ð Ð°Ð·Ð½Ð¸Ñ†Ð° `uses` vs `run`:**
- `uses:` - Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ Ð³Ð¾Ñ‚Ð¾Ð²Ñ‹Ð¹ action (ÐºÑ‚Ð¾-Ñ‚Ð¾ ÑƒÐ¶Ðµ Ð½Ð°Ð¿Ð¸ÑÐ°Ð»)
- `run:` - Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ Ð²Ð°ÑˆÑƒ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ Ð½Ð°Ð¿Ñ€ÑÐ¼ÑƒÑŽ

**ÐœÐ½Ð¾Ð³Ð¾ÑÑ‚Ñ€Ð¾Ñ‡Ð½Ñ‹Ð¹ `run:`:**
```yaml
run: |
  ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°1
  ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°2
  ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°3
```
`|` Ð¾Ð·Ð½Ð°Ñ‡Ð°ÐµÑ‚ Ð¼Ð½Ð¾Ð³Ð¾ÑÑ‚Ñ€Ð¾Ñ‡Ð½Ñ‹Ð¹ Ñ‚ÐµÐºÑÑ‚ (ÐºÐ°Ð¶Ð´Ð°Ñ ÑÑ‚Ñ€Ð¾ÐºÐ° - Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ð°Ñ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°)

---

### 2.4 Steps - Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ ÐºÐ¾Ð´Ð° (ÑÑ‚Ñ€Ð¾ÐºÐ¸ 44-48)

```yaml
- name: Check code formatting
  run: black --check app/

- name: Run linter
  run: flake8 app/ --count --statistics
```

**Ð§Ñ‚Ð¾ ÑÑ‚Ð¾:**
- `black --check` - Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ (Ð½Ðµ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚, Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚)
- `flake8` - Ð»Ð¸Ð½Ñ‚ÐµÑ€ (Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ ÑÑ‚Ð¸Ð»ÑŒ ÐºÐ¾Ð´Ð°, Ð¾ÑˆÐ¸Ð±ÐºÐ¸)

**ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚:**
```yaml
# Ð‘ÐµÐ· ÑÑ‚Ð¸Ñ… ÑˆÐ°Ð³Ð¾Ð² - ÐºÐ¾Ð´ Ð½Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ÑÑ Ð½Ð° Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ/ÑÑ‚Ð¸Ð»ÑŒ
```

**Ð§Ñ‚Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾:**
- ÐšÐ°Ñ‡ÐµÑÑ‚Ð²Ð¾ ÐºÐ¾Ð´Ð° - Ð³Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ñ€ÑƒÐµÑ‚ ÐµÐ´Ð¸Ð½Ñ‹Ð¹ ÑÑ‚Ð¸Ð»ÑŒ
- Ð Ð°Ð½Ð½ÐµÐµ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼ - Ð´Ð¾ Ð·Ð°Ð¿ÑƒÑÐºÐ° Ñ‚ÐµÑÑ‚Ð¾Ð²

---

### 2.5 Steps - Ñ‚ÐµÑÑ‚Ñ‹ (ÑÑ‚Ñ€Ð¾ÐºÐ¸ 50-57)

```yaml
- name: Run unit tests
  run: pytest app/tests/unit/ -v

- name: Run integration tests
  run: pytest app/tests/integration/ -v

- name: Generate coverage report
  run: pytest app/tests/ --cov=app --cov-report=term-missing --cov-report=xml
```

**Ð§Ñ‚Ð¾ ÑÑ‚Ð¾:**
- `pytest` - Ñ„Ñ€ÐµÐ¹Ð¼Ð²Ð¾Ñ€Ðº Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð¾Ð²
- `-v` - verbose (Ð¿Ð¾Ð´Ñ€Ð¾Ð±Ð½Ñ‹Ð¹ Ð²Ñ‹Ð²Ð¾Ð´)
- `--cov=app` - Ð¸Ð·Ð¼ÐµÑ€ÑÐµÑ‚ Ð¿Ð¾ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ ÐºÐ¾Ð´Ð° Ð´Ð»Ñ Ð¿Ð°Ð¿ÐºÐ¸ `app`
- `--cov-report=term-missing` - Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ Ð½ÐµÐ¿Ð¾ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ ÑÑ‚Ñ€Ð¾ÐºÐ¸ Ð² Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ð°Ð»Ðµ
- `--cov-report=xml` - ÑÐ¾Ð·Ð´Ð°ÐµÑ‚ XML Ñ„Ð°Ð¹Ð» Ð´Ð»Ñ Ð²Ð½ÐµÑˆÐ½Ð¸Ñ… ÑÐµÑ€Ð²Ð¸ÑÐ¾Ð²

**ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚:**
```yaml
- name: Run tests
  run: pytest
```

**Ð§Ñ‚Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾:**
- Ð Ð°Ð·Ð´ÐµÐ»ÐµÐ½Ð¸Ðµ unit Ð¸ integration Ñ‚ÐµÑÑ‚Ð¾Ð² - Ð²Ð¸Ð´Ð½Ð¾, ÐºÐ°ÐºÐ¸Ðµ ÑƒÐ¿Ð°Ð»Ð¸
- Coverage report - Ð¿Ð¾Ð½Ð¸Ð¼Ð°Ð½Ð¸Ðµ, ÑÐºÐ¾Ð»ÑŒÐºÐ¾ ÐºÐ¾Ð´Ð° Ð¿Ð¾ÐºÑ€Ñ‹Ñ‚Ð¾ Ñ‚ÐµÑÑ‚Ð°Ð¼Ð¸
- XML Ð¾Ñ‚Ñ‡ÐµÑ‚ - Ð´Ð»Ñ Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¸ Ñ Codecov

---

### 2.6 Step - Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° coverage (ÑÑ‚Ñ€Ð¾ÐºÐ¸ 59-62)

```yaml
- name: Upload coverage to Codecov (optional)
  uses: codecov/codecov-action@v3
  with:
    file: ./coverage.xml
```

**Ð§Ñ‚Ð¾ ÑÑ‚Ð¾:**
- `codecov-action` - Ð³Ð¾Ñ‚Ð¾Ð²Ñ‹Ð¹ action Ð´Ð»Ñ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ coverage
- `with: file:` - ÑƒÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ Ñ„Ð°Ð¹Ð» Ñ coverage Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸

**ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚:**
```yaml
# Ð‘ÐµÐ· ÑÑ‚Ð¾Ð³Ð¾ ÑˆÐ°Ð³Ð° - coverage Ð½Ðµ Ð·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÑ‚ÑÑ Ð² Codecov
```

**Ð§Ñ‚Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾:**
- Ð’Ð¸Ð·ÑƒÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ coverage - Ð²Ð¸Ð´Ð½Ð¾ Ð¿Ð¾ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Ð² UI
- Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð¿Ð¾ÐºÑ€Ñ‹Ñ‚Ð¸Ñ - Ð¾Ñ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹ Ð²Ð¾ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸

---

## 3. Job: `docker` (ÑÑ‚Ñ€Ð¾ÐºÐ¸ 64-135)

### 3.1 Ð—Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸ Ð¼ÐµÐ¶Ð´Ñƒ jobs

```yaml
docker:
  runs-on: ubuntu-latest
  needs: test
```

**Ð§Ñ‚Ð¾ ÑÑ‚Ð¾:**
- `needs: test` - ÑÑ‚Ð¾Ñ‚ job Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑÑ Ð¢ÐžÐ›Ð¬ÐšÐž Ð¿Ð¾ÑÐ»Ðµ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾Ð³Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ `test`
- Ð•ÑÐ»Ð¸ `test` ÑƒÐ¿Ð°Ð» - `docker` Ð½Ðµ Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑÑ

**ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚:**
```yaml
docker:
  runs-on: ubuntu-latest
  # Ð‘ÐµÐ· needs - Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑÑ Ð¿Ð°Ñ€Ð°Ð»Ð»ÐµÐ»ÑŒÐ½Ð¾ Ñ test
```

**Ð§Ñ‚Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾:**
- ÐŸÐ¾ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ - ÑÐºÐ¾Ð½Ð¾Ð¼Ð¸Ñ‚ Ñ€ÐµÑÑƒÑ€ÑÑ‹ (Ð½Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ Docker, ÐµÑÐ»Ð¸ Ñ‚ÐµÑÑ‚Ñ‹ ÑƒÐ¿Ð°Ð»Ð¸)
- Ð›Ð¾Ð³Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÑŒ - Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Docker Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐµÑÐ»Ð¸ ÐºÐ¾Ð´ Ð¿Ñ€Ð¾ÑˆÐµÐ» Ñ‚ÐµÑÑ‚Ñ‹

---

### 3.2 Docker Buildx (ÑÑ‚Ñ€Ð¾ÐºÐ¸ 71-81)

```yaml
- name: Set up Docker Buildx
  uses: docker/setup-buildx-action@v3

- name: Build Docker image
  uses: docker/build-push-action@v5
  with:
    context: .
    push: false
    tags: expense-tracker:test
    cache-from: type=gha
    cache-to: type=gha,mode=max
```

**Ð§Ñ‚Ð¾ ÑÑ‚Ð¾:**
- `buildx` - Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ `docker build` Ñ ÐºÑÑˆÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼
- `context: .` - Ð¿Ð°Ð¿ÐºÐ° Ð´Ð»Ñ ÑÐ±Ð¾Ñ€ÐºÐ¸ (Ñ‚ÐµÐºÑƒÑ‰Ð°Ñ Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸Ñ)
- `push: false` - Ð½Ðµ Ð¿ÑƒÑˆÐ¸Ñ‚ÑŒ Ð¾Ð±Ñ€Ð°Ð· Ð² registry (Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑÐ¾Ð±Ñ€Ð°Ñ‚ÑŒ)
- `tags:` - Ñ‚ÐµÐ³ Ð´Ð»Ñ Ð¾Ð±Ñ€Ð°Ð·Ð°
- `cache-from/to: type=gha` - ÐºÑÑˆ Ñ‡ÐµÑ€ÐµÐ· GitHub Actions cache

**ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚:**
```yaml
- name: Build Docker image
  run: docker build -t expense-tracker:test .
```

**Ð§Ñ‚Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾:**
- Buildx - Ð±Ð¾Ð»ÐµÐµ Ð±Ñ‹ÑÑ‚Ñ€Ð°Ñ ÑÐ±Ð¾Ñ€ÐºÐ°
- ÐšÑÑˆÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ - ÑƒÑÐºÐ¾Ñ€ÑÐµÑ‚ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ñ‹Ðµ ÑÐ±Ð¾Ñ€ÐºÐ¸
- ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ - Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ ÐºÑÑˆ ÑÐ»Ð¾ÐµÐ² Docker

---

### 3.3 Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ .env Ñ„Ð°Ð¹Ð»Ð° (ÑÑ‚Ñ€Ð¾ÐºÐ¸ 83-90)

```yaml
- name: Create test .env file
  run: |
    cat > .env << EOF
    DATABASE_URL=postgresql://postgres:postgres@db:5432/expensetracker_test
    POSTGRES_USER=postgres
    POSTGRES_PASSWORD=postgres
    POSTGRES_DB=expensetracker_test
    EOF
```

**Ð§Ñ‚Ð¾ ÑÑ‚Ð¾:**
- `cat > .env << EOF` - heredoc ÑÐ¸Ð½Ñ‚Ð°ÐºÑÐ¸Ñ (ÑÐ¾Ð·Ð´Ð°ÐµÑ‚ Ñ„Ð°Ð¹Ð» Ñ Ð¼Ð½Ð¾Ð³Ð¾ÑÑ‚Ñ€Ð¾Ñ‡Ð½Ñ‹Ð¼ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ñ‹Ð¼)
- `EOF` - Ð¼Ð°Ñ€ÐºÐµÑ€ ÐºÐ¾Ð½Ñ†Ð° heredoc
- Ð¡Ð¾Ð·Ð´Ð°ÐµÑ‚ `.env` Ñ„Ð°Ð¹Ð» Ð´Ð»Ñ docker-compose

**ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚:**
```yaml
# Ð‘ÐµÐ· ÑÑ‚Ð¾Ð³Ð¾ - docker-compose Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÑ‚ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ
```

**Ð§Ñ‚Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾:**
- ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð°Ñ†Ð¸Ñ - Ð½Ðµ Ð½ÑƒÐ¶Ð½Ð¾ Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ ÑÐ¾Ð·Ð´Ð°Ð²Ð°Ñ‚ÑŒ Ñ„Ð°Ð¹Ð»
- Ð˜Ð·Ð¾Ð»ÑÑ†Ð¸Ñ - Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ð¾ Ð¾Ñ‚ production

**Ð¡Ð¸Ð½Ñ‚Ð°ÐºÑÐ¸Ñ heredoc:**
```bash
cat > Ñ„Ð°Ð¹Ð» << MARKER
ÑÑ‚Ñ€Ð¾ÐºÐ°1
ÑÑ‚Ñ€Ð¾ÐºÐ°2
MARKER
```
Ð’ÑÐµ Ð¼ÐµÐ¶Ð´Ñƒ `<< MARKER` Ð¸ `MARKER` Ð·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÑ‚ÑÑ Ð² Ñ„Ð°Ð¹Ð»

---

### 3.4 Ð—Ð°Ð¿ÑƒÑÐº docker-compose (ÑÑ‚Ñ€Ð¾ÐºÐ¸ 92-97)

```yaml
- name: Start services with docker compose
  run: docker compose up -d

- name: Wait for database to be ready
  run: |
    timeout 30 bash -c 'until docker compose exec -T db pg_isready -U postgres; do sleep 2; done'
```

**Ð§Ñ‚Ð¾ ÑÑ‚Ð¾:**
- `docker compose up -d` - Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ ÑÐµÑ€Ð²Ð¸ÑÑ‹ Ð² Ñ„Ð¾Ð½Ðµ (detached mode)
- `timeout 30` - Ð¼Ð°ÐºÑÐ¸Ð¼ÑƒÐ¼ 30 ÑÐµÐºÑƒÐ½Ð´ Ð½Ð° Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ
- `until ... done` - Ñ†Ð¸ÐºÐ»: Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÑÐµÑ‚ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ, Ð¿Ð¾ÐºÐ° Ð¾Ð½Ð° Ð½Ðµ Ð²ÐµÑ€Ð½ÐµÑ‚ ÑƒÑÐ¿ÐµÑ…
- `pg_isready` - Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ Ð³Ð¾Ñ‚Ð¾Ð²Ð½Ð¾ÑÑ‚ÑŒ PostgreSQL

**ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚:**
```yaml
- name: Start services
  run: docker compose up -d
  # Ð‘ÐµÐ· Ð¾Ð¶Ð¸Ð´Ð°Ð½Ð¸Ñ - Ð¼Ð¾Ð¶ÐµÑ‚ Ð½Ð°Ñ‡Ð°Ñ‚ÑŒ Ñ‚ÐµÑÑ‚Ñ‹ Ð´Ð¾ Ð³Ð¾Ñ‚Ð¾Ð²Ð½Ð¾ÑÑ‚Ð¸ Ð‘Ð”
```

**Ð§Ñ‚Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾:**
- ÐžÐ¶Ð¸Ð´Ð°Ð½Ð¸Ðµ Ð‘Ð” - Ð³Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ñ€ÑƒÐµÑ‚, Ñ‡Ñ‚Ð¾ Ð‘Ð” Ð³Ð¾Ñ‚Ð¾Ð²Ð° Ð¿ÐµÑ€ÐµÐ´ Ñ‚ÐµÑÑ‚Ð°Ð¼Ð¸
- `timeout` - Ð·Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ Ð±ÐµÑÐºÐ¾Ð½ÐµÑ‡Ð½Ð¾Ð³Ð¾ Ð¾Ð¶Ð¸Ð´Ð°Ð½Ð¸Ñ

**Ð¡Ð¸Ð½Ñ‚Ð°ÐºÑÐ¸Ñ `until`:**
```bash
until ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°; do
  sleep 2
done
```
ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€ÑÐµÑ‚ `sleep 2`, Ð¿Ð¾ÐºÐ° `ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°` Ð½Ðµ Ð²ÐµÑ€Ð½ÐµÑ‚ ÑƒÑÐ¿ÐµÑ… (exit code 0)

---

### 3.5 ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° health endpoint (ÑÑ‚Ñ€Ð¾ÐºÐ¸ 99-106)

```yaml
- name: Install curl
  run: sudo apt-get update && sudo apt-get install -y curl

- name: Wait for app to be healthy
  run: |
    echo "Waiting for app to start..."
    timeout 60 bash -c 'until curl -f http://localhost:8000/health; do sleep 2; done'
    echo "App is healthy!"
```

**Ð§Ñ‚Ð¾ ÑÑ‚Ð¾:**
- `curl -f` - Ð´ÐµÐ»Ð°ÐµÑ‚ HTTP Ð·Ð°Ð¿Ñ€Ð¾Ñ, `-f` Ð¾Ð·Ð½Ð°Ñ‡Ð°ÐµÑ‚ "fail on error" (Ð²ÐµÑ€Ð½ÐµÑ‚ Ð¾ÑˆÐ¸Ð±ÐºÑƒ Ð¿Ñ€Ð¸ 4xx/5xx)
- ÐžÐ¶Ð¸Ð´Ð°ÐµÑ‚, Ð¿Ð¾ÐºÐ° Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ð²ÐµÑ‚Ð¸Ñ‚ Ð½Ð° `/health`

**ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚:**
```yaml
# Ð‘ÐµÐ· ÑÑ‚Ð¾Ð³Ð¾ - Ð½Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ñ‡Ñ‚Ð¾ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ð»Ð¾ÑÑŒ
```

**Ð§Ñ‚Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾:**
- ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð·Ð°Ð¿ÑƒÑÐºÐ° - ÑƒÐ±ÐµÐ¶Ð´Ð°ÐµÐ¼ÑÑ, Ñ‡Ñ‚Ð¾ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚
- Health check - ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½Ð°Ñ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ° Ð´Ð»Ñ ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ñ… Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ð¹

---

### 3.6 Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ endpoints (ÑÑ‚Ñ€Ð¾ÐºÐ¸ 108-118)

```yaml
- name: Test root endpoint
  run: |
    response=$(curl -s http://localhost:8000/)
    echo "Root endpoint response: $response"
    echo "$response" | grep -q "Expense Tracker is running" || exit 1
```

**Ð§Ñ‚Ð¾ ÑÑ‚Ð¾:**
- `response=$(...)` - ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚ Ð²Ñ‹Ð²Ð¾Ð´ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ Ð² Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ
- `curl -s` - silent mode (Ð±ÐµÐ· Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑ-Ð±Ð°Ñ€Ð°)
- `grep -q` - Ð¸Ñ‰ÐµÑ‚ Ñ‚ÐµÐºÑÑ‚, `-q` = quiet (Ð½Ðµ Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ñ‚ Ð½Ð°Ð¹Ð´ÐµÐ½Ð½Ð¾Ðµ, Ñ‚Ð¾Ð»ÑŒÐºÐ¾ exit code)
- `|| exit 1` - ÐµÑÐ»Ð¸ grep Ð½Ðµ Ð½Ð°ÑˆÐµÐ» Ñ‚ÐµÐºÑÑ‚, Ð·Ð°Ð²ÐµÑ€ÑˆÐ¸Ñ‚ÑŒ Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ¾Ð¹

**ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚:**
```yaml
# Ð‘ÐµÐ· ÑÑ‚Ð¾Ð³Ð¾ - Ð½Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ endpoints
```

**Ð§Ñ‚Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾:**
- Ð¤ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ðµ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ - Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ñ‡Ñ‚Ð¾ API Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚
- Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð¾Ñ‚Ð²ÐµÑ‚Ð¾Ð² - ÑƒÐ±ÐµÐ¶Ð´Ð°ÐµÐ¼ÑÑ Ð² Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ñ…

**Ð¡Ð¸Ð½Ñ‚Ð°ÐºÑÐ¸Ñ `||`:**
```bash
ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°1 || ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°2
```
Ð•ÑÐ»Ð¸ `ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°1` ÑƒÐ¿Ð°Ð»Ð° (exit code != 0), Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ `ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°2`

---

### 3.7 Ð£ÑÐ»Ð¾Ð²Ð½Ñ‹Ðµ ÑˆÐ°Ð³Ð¸ (ÑÑ‚Ñ€Ð¾ÐºÐ¸ 125-135)

```yaml
- name: Check container logs
  if: failure()
  run: |
    echo "=== App logs ==="
    docker compose logs app

- name: Stop services
  if: always()
  run: docker compose down -v
```

**Ð§Ñ‚Ð¾ ÑÑ‚Ð¾:**
- `if: failure()` - Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ÑÑ Ð¢ÐžÐ›Ð¬ÐšÐž ÐµÑÐ»Ð¸ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰Ð¸Ð¹ ÑˆÐ°Ð³ ÑƒÐ¿Ð°Ð»
- `if: always()` - Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ÑÑ Ð’Ð¡Ð•Ð“Ð”Ð (Ð´Ð°Ð¶Ðµ ÐµÑÐ»Ð¸ job ÑƒÐ¿Ð°Ð»)

**ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚:**
```yaml
- name: Stop services
  run: docker compose down -v
  # Ð‘ÐµÐ· if: always() - Ð¼Ð¾Ð¶ÐµÑ‚ Ð½Ðµ Ð¾ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ñ‹ Ð¿Ñ€Ð¸ Ð¾ÑˆÐ¸Ð±ÐºÐµ
```

**Ð§Ñ‚Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾:**
- Ð›Ð¾Ð³Ð¸ Ð¿Ñ€Ð¸ Ð¾ÑˆÐ¸Ð±ÐºÐµ - Ð¿Ð¾Ð¼Ð¾Ð³Ð°ÐµÑ‚ Ð¾Ñ‚Ð»Ð°Ð´Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñƒ
- Cleanup - Ð²ÑÐµÐ³Ð´Ð° Ð¾ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÑ‚ ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ñ‹ (Ð½Ðµ Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ "Ð¼ÑƒÑÐ¾Ñ€")

**Ð£ÑÐ»Ð¾Ð²Ð¸Ñ:**
- `if: success()` - Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ñ€Ð¸ ÑƒÑÐ¿ÐµÑ…Ðµ
- `if: failure()` - Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ñ€Ð¸ Ð¾ÑˆÐ¸Ð±ÐºÐµ
- `if: always()` - Ð²ÑÐµÐ³Ð´Ð°
- `if: cancelled()` - Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ñ€Ð¸ Ð¾Ñ‚Ð¼ÐµÐ½Ðµ

---

## 4. Job: `deploy` (ÑÑ‚Ñ€Ð¾ÐºÐ¸ 137-156)

### 4.1 Ð£ÑÐ»Ð¾Ð²Ð¸Ñ Ð·Ð°Ð¿ÑƒÑÐºÐ°

```yaml
deploy:
  runs-on: ubuntu-latest
  needs: [test, docker]
  if: github.ref == 'refs/heads/main' && github.event_name == 'push'
```

**Ð§Ñ‚Ð¾ ÑÑ‚Ð¾:**
- `needs: [test, docker]` - Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ Ð¿Ð¾ÑÐ»Ðµ ÐžÐ‘ÐžÐ˜Ð¥ jobs
- `if:` - ÑƒÑÐ»Ð¾Ð²Ð¸Ðµ Ð´Ð»Ñ Ð·Ð°Ð¿ÑƒÑÐºÐ° job
- `github.ref` - ÑÑÑ‹Ð»ÐºÐ° Ð½Ð° Ð²ÐµÑ‚ÐºÑƒ/Ñ‚ÐµÐ³
- `github.event_name` - Ñ‚Ð¸Ð¿ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ (push, pull_request Ð¸ Ñ‚.Ð´.)

**ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚:**
```yaml
deploy:
  runs-on: ubuntu-latest
  # Ð‘ÐµÐ· ÑƒÑÐ»Ð¾Ð²Ð¸Ð¹ - Ð´ÐµÐ¿Ð»Ð¾Ð¸Ñ‚ Ð²ÑÐµÐ³Ð´Ð° (Ð´Ð°Ð¶Ðµ Ð½Ð° PR!)
```

**Ð§Ñ‚Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾:**
- Ð—Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ ÑÐ»ÑƒÑ‡Ð°Ð¹Ð½Ð¾Ð³Ð¾ Ð´ÐµÐ¿Ð»Ð¾Ñ - Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð½Ð° `main`
- Ð¢Ð¾Ð»ÑŒÐºÐ¾ Ð½Ð° push - Ð½Ðµ Ð´ÐµÐ¿Ð»Ð¾Ð¸Ñ‚ Ð½Ð° PR (Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ)

**GitHub ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚:**
- `github.ref` - Ð¿Ð¾Ð»Ð½Ð°Ñ ÑÑÑ‹Ð»ÐºÐ° (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, `refs/heads/main`)
- `github.event_name` - `push`, `pull_request`, `workflow_dispatch` Ð¸ Ñ‚.Ð´.

---

### 4.2 ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð² step

```yaml
- name: Deploy to Render
  env:
    RENDER_API_KEY: ${{ secrets.RENDER_API_KEY }}
    RENDER_SERVICE_ID: srv-d5mseh8gjchc738umbdg
  run: |
    curl -X POST "https://api.render.com/v1/services/${RENDER_SERVICE_ID}/deploys" \
      -H "Authorization: Bearer ${RENDER_API_KEY}" \
      ...
```

**Ð§Ñ‚Ð¾ ÑÑ‚Ð¾:**
- `env:` Ð² step - Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð»Ñ ÑÑ‚Ð¾Ð³Ð¾ ÑˆÐ°Ð³Ð°
- `${{ secrets.RENDER_API_KEY }}` - ÑÐ¸Ð½Ñ‚Ð°ÐºÑÐ¸Ñ GitHub Actions Ð´Ð»Ñ ÑÐµÐºÑ€ÐµÑ‚Ð¾Ð²
- `${RENDER_SERVICE_ID}` - bash Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð°Ñ (Ð¸Ð· `env:`)

**ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚:**
```yaml
- name: Deploy
  run: curl ...
  # Ð‘ÐµÐ· env - Ð½ÑƒÐ¶Ð½Ð¾ Ñ…Ð°Ñ€Ð´ÐºÐ¾Ð´Ð¸Ñ‚ÑŒ ÐºÐ»ÑŽÑ‡Ð¸ (Ð½ÐµÐ±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾!)
```

**Ð§Ñ‚Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾:**
- Ð‘ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ - API ÐºÐ»ÑŽÑ‡ Ð² Secrets, Ð½Ðµ Ð² ÐºÐ¾Ð´Ðµ
- ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ - ÑƒÐ´Ð¾Ð±Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð² ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°Ñ…

**Ð¡Ð¸Ð½Ñ‚Ð°ÐºÑÐ¸Ñ GitHub Actions:**
- `${{ }}` - Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ GitHub Actions (Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ÑÑ Ð´Ð¾ Ð·Ð°Ð¿ÑƒÑÐºÐ°)
- `secrets.NAME` - Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ðº ÑÐµÐºÑ€ÐµÑ‚Ð°Ð¼ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ
- `${VAR}` - bash Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð°Ñ (Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ÑÑ Ð²Ð¾ Ð²Ñ€ÐµÐ¼Ñ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ)

---

## ðŸ“Š Ð¡Ñ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ: ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ vs Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹

### ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ CI (Ð±Ð°Ð·Ð¾Ð²Ñ‹Ð¹):

```yaml
name: CI

on: [push]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-python@v4
        with:
          python-version: '3.11'
      - run: pip install -r requirements.txt
      - run: pytest
```

**Ð§Ñ‚Ð¾ Ð´ÐµÐ»Ð°ÐµÑ‚:**
- âœ… ÐšÐ»Ð¾Ð½Ð¸Ñ€ÑƒÐµÑ‚ ÐºÐ¾Ð´
- âœ… Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÑ‚ Python
- âœ… Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÑ‚ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸
- âœ… Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ Ñ‚ÐµÑÑ‚Ñ‹

**Ð§ÐµÐ³Ð¾ Ð½Ðµ Ñ…Ð²Ð°Ñ‚Ð°ÐµÑ‚:**
- âŒ ÐÐµÑ‚ Ð‘Ð” Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð¾Ð²
- âŒ ÐÐµÑ‚ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
- âŒ ÐÐµÑ‚ Ð»Ð¸Ð½Ñ‚ÐµÑ€Ð°
- âŒ ÐÐµÑ‚ coverage
- âŒ ÐÐµÑ‚ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Docker
- âŒ ÐÐµÑ‚ Ð´ÐµÐ¿Ð»Ð¾Ñ

---

### Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹ CI (Ð¿Ð¾Ð»Ð½Ñ‹Ð¹):

**Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾:**
1. âœ… Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð¿Ð¾ Ð²ÐµÑ‚ÐºÐ°Ð¼
2. âœ… PostgreSQL service Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð¾Ð²
3. âœ… ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ
4. âœ… ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ (black)
5. âœ… Ð›Ð¸Ð½Ñ‚ÐµÑ€ (flake8)
6. âœ… Ð Ð°Ð·Ð´ÐµÐ»ÐµÐ½Ð¸Ðµ unit/integration Ñ‚ÐµÑÑ‚Ð¾Ð²
7. âœ… Coverage Ð¾Ñ‚Ñ‡ÐµÑ‚
8. âœ… Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° coverage Ð² Codecov
9. âœ… ÐžÑ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ð¹ job Ð´Ð»Ñ Docker
10. âœ… ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÐ±Ð¾Ñ€ÐºÐ¸ Docker Ð¾Ð±Ñ€Ð°Ð·Ð°
11. âœ… Ð—Ð°Ð¿ÑƒÑÐº Ñ‡ÐµÑ€ÐµÐ· docker-compose
12. âœ… Health checks
13. âœ… Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ endpoints
14. âœ… Ð£ÑÐ»Ð¾Ð²Ð½Ñ‹Ðµ ÑˆÐ°Ð³Ð¸ (Ð»Ð¾Ð³Ð¸ Ð¿Ñ€Ð¸ Ð¾ÑˆÐ¸Ð±ÐºÐµ)
15. âœ… Cleanup ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð¾Ð²
16. âœ… Ð”ÐµÐ¿Ð»Ð¾Ð¹ Ð½Ð° Render
17. âœ… Ð£ÑÐ»Ð¾Ð²Ð¸Ñ Ð´Ð»Ñ Ð´ÐµÐ¿Ð»Ð¾Ñ (Ñ‚Ð¾Ð»ÑŒÐºÐ¾ main)

---

## ðŸŽ¯ ÐšÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ ÐºÐ¾Ð½Ñ†ÐµÐ¿Ñ†Ð¸Ð¸

### 1. Jobs vs Steps
- **Job** - Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ð°Ñ Ð·Ð°Ð´Ð°Ñ‡Ð°, Ð¼Ð¾Ð¶ÐµÑ‚ Ð·Ð°Ð¿ÑƒÑÐºÐ°Ñ‚ÑŒÑÑ Ð¿Ð°Ñ€Ð°Ð»Ð»ÐµÐ»ÑŒÐ½Ð¾
- **Step** - ÑˆÐ°Ð³ Ð²Ð½ÑƒÑ‚Ñ€Ð¸ job, Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ÑÑ Ð¿Ð¾ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾

### 2. Ð—Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸
- `needs: [job1, job2]` - job Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑÑ Ð¿Ð¾ÑÐ»Ðµ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾Ð³Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ job1 Ð¸ job2

### 3. Ð£ÑÐ»Ð¾Ð²Ð¸Ñ
- `if:` - ÑƒÑÐ»Ð¾Ð²Ð¸Ðµ Ð´Ð»Ñ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ step/job
- `github.ref`, `github.event_name` - ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚ GitHub

### 4. ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ
- `env:` Ð½Ð° ÑƒÑ€Ð¾Ð²Ð½Ðµ job - Ð´Ð»Ñ Ð²ÑÐµÑ… steps
- `env:` Ð½Ð° ÑƒÑ€Ð¾Ð²Ð½Ðµ step - Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð»Ñ ÑÑ‚Ð¾Ð³Ð¾ step
- `${{ secrets.NAME }}` - ÑÐµÐºÑ€ÐµÑ‚Ñ‹ Ð¸Ð· GitHub

### 5. Services
- Ð—Ð°Ð¿ÑƒÑÐºÐ°ÑŽÑ‚ÑÑ Ð”Ðž steps
- Ð”Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹ Ñ‡ÐµÑ€ÐµÐ· localhost
- Health checks Ð³Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ñ€ÑƒÑŽÑ‚ Ð³Ð¾Ñ‚Ð¾Ð²Ð½Ð¾ÑÑ‚ÑŒ

### 6. Actions
- `uses:` - Ð¿ÐµÑ€ÐµÐ¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼Ñ‹Ð¹ ÐºÐ¾Ð´
- `with:` - Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ Ð´Ð»Ñ action
- `actions/checkout` - Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð´Ð»Ñ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº ÐºÐ¾Ð´Ñƒ

---

## ðŸ’¡ Best Practices

1. **Ð Ð°Ð·Ð´ÐµÐ»ÐµÐ½Ð¸Ðµ jobs** - Ð»Ð¾Ð³Ð¸Ñ‡ÐµÑÐºÐ¸ ÑÐ²ÑÐ·Ð°Ð½Ð½Ñ‹Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð² Ð¾Ð´Ð½Ð¾Ð¼ job
2. **Ð—Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸** - Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ `needs:` Ð´Ð»Ñ Ð¿Ð¾ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸
3. **Ð£ÑÐ»Ð¾Ð²Ð¸Ñ** - Ð·Ð°Ñ‰Ð¸Ñ‰Ð°Ð¹Ñ‚Ðµ Ð´ÐµÐ¿Ð»Ð¾Ð¹ ÑƒÑÐ»Ð¾Ð²Ð¸ÑÐ¼Ð¸ (`if:`)
4. **Ð¡ÐµÐºÑ€ÐµÑ‚Ñ‹** - Ð½Ð¸ÐºÐ¾Ð³Ð´Ð° Ð½Ðµ Ñ…Ð°Ñ€Ð´ÐºÐ¾Ð´Ð¸Ñ‚Ðµ ÐºÐ»ÑŽÑ‡Ð¸
5. **Cleanup** - Ð²ÑÐµÐ³Ð´Ð° Ð¾Ñ‡Ð¸Ñ‰Ð°Ð¹Ñ‚Ðµ Ñ€ÐµÑÑƒÑ€ÑÑ‹ (`if: always()`)
6. **Health checks** - Ð¶Ð´Ð¸Ñ‚Ðµ Ð³Ð¾Ñ‚Ð¾Ð²Ð½Ð¾ÑÑ‚Ð¸ ÑÐµÑ€Ð²Ð¸ÑÐ¾Ð²
7. **Ð›Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ** - Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ñ‚Ðµ Ð»Ð¾Ð³Ð¸ Ð¿Ñ€Ð¸ Ð¾ÑˆÐ¸Ð±ÐºÐ°Ñ…
